# Light It Up

Vulnerability found in the Magic Home Mobile Application which is used to interface with the [JadeHomic](https://www.amazon.com.au/s?me=A4PYNSFB834M3&marketplaceID=A39IBJ37TRP1C6) LED Strip RGB Kit.  Vulnerability allows for unauthorized access and control of a remote endpoint, by an authenticated user. Unauthorized enumeration of a remote endpoint and sending of batch commands to the remote endpoint.

## Pre-Work to finding

- Rooted Android
- Root detection bypassed through patch, Re-signed JAR and Rebuilt APK (required)
- Certificate Pinning bypass [Frida to the rescue] (required)

# CVE (TBA)

#### Application

[Magic Home Pro](https://play.google.com/store/apps/details?id=com.zengge.wifi&hl=en)

#### Vendor of Product

[JadeHomic](https://www.amazon.com.au/s?me=A4PYNSFB834M3&marketplaceID=A39IBJ37TRP1C6)

#### WiFi Controller Product Owner

[Suzhou SmartChip Semiconductor Co.,Ltd](https://fccid.io/2AKCE)

#### Vendor Website

[JadeHomic](https://www.amazon.com.au/s?me=A4PYNSFB834M3&marketplaceID=A39IBJ37TRP1C6)

#### CVE Reference

https://cve.mitre.org/cgi-bin/cvename.cgi?name=TBA

#### Affected Product Code Base

[Magic Home Pro](https://play.google.com/store/apps/details?id=com.zengge.wifi&hl=en)

### Description

#### Infomation Disclosure

This vulnerability allows for any authenticated user to utilise their current authorization level to interrogate end points not apart of their registered products, using an API call to **/app/getBindedUserListByMacAddress/ZG001?macAddress=\<mac address\>**.  This results in a HTTP response that indicates the existence of the endpoint and returns the Username, User Unique Identifier (userUniID) and the Binded Unique ID (bindedUniID) of the associated endpoint.

#### Unauthorized Access and Horizontal Privilege Escalation

Using the above interrogation, an attacker is then able to utilise an unauthorized POST request to API **/app/sendCommandBatch/ZG001**, using the newly enumerated mac address to switch on and off the LED strip using respective hex commands **71230fa3** and **71240fa4**.

#### Vulnerability Type

- Information Disclosure
- Unauthorized Access
- Horizontal Privilege Escalation.

#### Additional Information

##### OUI

The OUI describes the Organisation Unique Identifier for MAC Addresses registered to an organisation.  In the case of JadeHomic the magic OUI is **C8:2E:47**, where  the first three bytes corresponds to the manufacturer and the second 3 bytes correspond to the serial number assigned by the manufacturer. In our case the manufacturer identifier is registered to **Suzhou SmartChip Semiconductor Co., LTD**.

#### CVE Impact Other

Allows for an authenticated user unauthorized remote control of endpoint.

#### Attack Vectors

- Authenticated user required 
- Succesful Enumeration of existing end system
- Subsequent sending of batch commands to an remote endpoint

#### Discoverer

V.Hanna - SpiderLabs
